# General sources
set(SOURCES_FILES AVAILMEM.CPP CMDLINE.CPP DEFFILE.CPP DISKDIR.CPP DISPCPU.CPP DISPOS.CPP EXIT.CPP FILEBAK.CPP
        FILECOPY.CPP FILENAME.CPP FILES.CPP HQFILE.CPP HQMEM.CPP HQRLOAD.CPP HQRMEM.CPP HQRMLOAD.CPP HQRRESS.CPP
        INITIMER.CPP INITKEYB.CPP INPUT.CPP ITOA.CPP LOADMALL.CPP LOADSAVE.CPP LOGPRINT.CPP N_MALLOC.CPP S_MALLOC.CPP)
set(SOURCES_FILES_ASM CHOOSER.ASM CPU.ASM FASTCPY.ASM FASTCPYF.ASM FASTCPYI.ASM FASTCPYM.ASM FASTSET.ASM FASTSETF.ASM
        FASTSETI.ASM FASTSETM.ASM LZ.ASM)

# Windows specific sources
set(SOURCES_FILES_WIN KEYBWIN.CPP TIMERWIN.CPP WINSYS.CPP)
set(SOURCES_FILES_ASM_WIN PATCH.ASM)

# DOS specific sources
set(SOURCES_FILES_DOS A_MALLOC.CPP DOSSYS.CPP)
set(SOURCES_FILES_ASM_DOS DOSMALLO.ASM KEYBDOS.ASM TIMERDOS.ASM)

add_library(sys ${SOURCES_FILES} ${SOURCES_FILES_ASM} ${SOURCES_FILES_WIN} ${SOURCES_FILES_ASM_WIN})
target_compile_definitions(sys PRIVATE _BUILDING_LIB LIB_LOCAL)

# Configure all ASM files to be recognized as such (workaround for bug where .ASM uppercase extension is not recognized)
foreach (FILE_ASM IN LISTS SOURCES_FILES_ASM SOURCES_FILES_ASM_WIN SOURCES_FILES_ASM_DOS)
    set_source_files_properties(${FILE_ASM} PROPERTIES LANGUAGE ASM_MASM)
endforeach ()

# Files in folder but not used:
# - SCANINP.CPP
# - WIN.CPP
